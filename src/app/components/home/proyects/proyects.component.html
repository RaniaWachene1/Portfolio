<section class="section projects-section" id="proyects">
  <div class="container">
    <div class="section-box">
      
      <div class="about-title mb-5" data-aos="fade-up" data-aos-duration="1000">
        <h3 class="section-title">
          <span class='n-section-title'>05.</span> {{"FeatureProjects.Title" | translate}}
        </h3>
      </div>

      <div class="projects-grid">
        <div 
          class="project-card" 
          *ngFor="let project of 'FeatureProjects.Projects' | translate; let i = index"
          data-aos="fade-up" 
          data-aos-duration="1000"
          [attr.data-aos-delay]="i * 100">
          
          <div class="project-image-container" (click)="openModal(project, i)">
            <div class="project-image-wrapper">
              <img 
                [src]="project.imgs[0]" 
                [alt]="project.Title"
                class="project-image">
              <div class="image-overlay">
                <div class="overlay-content">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                    <line x1="11" y1="8" x2="11" y2="14"/>
                    <line x1="8" y1="11" x2="14" y2="11"/>
                  </svg>
                  <span>View Details</span>
                </div>
              </div>
            </div>
            
            <div class="project-number">
              <span>{{ (i + 1).toString().padStart(2, '0') }}</span>
            </div>
          </div>

          <div class="project-info">
            <div class="project-label">
              <span class="label-dot"></span>
              <span class="label-text">{{"FeatureProjects.Label" | translate}}</span>
            </div>
            <h3 class="project-title">{{ project.Title }}</h3>
            <p class="project-description" [innerHTML]="project.Description"></p>

            <div class="project-tech">
              <span class="tech-tag" *ngFor="let tech of project.Technologies">{{ tech }}</span>
            </div>

            <div class="project-actions">
              <a *ngIf="project.ghLink" [href]="project.ghLink" target="_blank" class="project-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
                <span>Code</span>
              </a>
              <button class="view-full-btn" (click)="openModal(project, i)">
                <span>View Full Project</span>
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="project-modal" *ngIf="isModalOpen" (click)="closeModal()">
  <div class="modal-overlay"></div>
  <div class="modal-container" (click)="$event.stopPropagation()" [@modalAnimation]>
    
    <button class="modal-close" (click)="closeModal()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>

    <div class="modal-content" *ngIf="selectedProject">
      
      <div class="modal-header">
        <div class="modal-header-left">
          <div class="modal-label">
            <span class="label-dot"></span>
            <span>{{"FeatureProjects.Label" | translate}}</span>
          </div>
          <div class="project-number-badge">
            <span>Project #{{ (selectedProjectIndex + 1).toString().padStart(2, '0') }}</span>
          </div>
        </div>
        <div class="modal-header-right">
          <h2 class="modal-title">{{ selectedProject.Title }}</h2>
          <p class="modal-overview">{{ selectedProject.overview?.description || selectedProject.Description }}</p>
        </div>
      </div>

      <div class="screenshot-gallery" *ngIf="selectedProject.imgs?.length > 0">
        <div class="gallery-main">
          <div class="screenshot-container">
            <img [src]="selectedProject.imgs[currentScreenshotIndex]" class="screenshot-image">
          </div>
          <button class="gallery-nav prev" (click)="previousScreenshot()" *ngIf="selectedProject.imgs.length > 1">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
          </button>
          <button class="gallery-nav next" (click)="nextScreenshot()" *ngIf="selectedProject.imgs.length > 1">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
          </button>
        </div>
        <div class="gallery-thumbnails" *ngIf="selectedProject.imgs.length > 1">
          <div class="thumbnail" *ngFor="let s of selectedProject.imgs; let idx = index" [class.active]="idx === currentScreenshotIndex" (click)="goToScreenshot(idx)">
            <img [src]="s">
          </div>
        </div>
      </div>

      <div class="metrics-grid" *ngIf="selectedProject.keyMetrics">
        <div class="metric-card" *ngFor="let metric of selectedProject.keyMetrics">
          <span class="metric-value">{{ metric.value }}</span>
          <span class="metric-label">{{ metric.label }}</span>
        </div>
      </div>

      <div class="modal-body-layout">
        
        <div class="modal-main-col">
          
          <div class="modal-section" *ngIf="selectedProject.technicalStack">
            <h3 class="modal-section-title">Technical Stack</h3>
            <div class="tech-category-wrapper" *ngFor="let category of selectedProject.technicalStack | keyvalue">
              <h4 class="tech-cat-title">{{ category.key }}</h4>
              <div class="tech-stack-list">
                <span class="tag" *ngFor="let tech of category.value">{{ tech }}</span>
              </div>
            </div>
          </div>

          <div class="modal-section" *ngIf="selectedProject.pipelineFeatures">
            <h3 class="modal-section-title">CI/CD & DevSecOps Pipeline</h3>
            <div class="pipeline-feature-card" *ngFor="let feature of selectedProject.pipelineFeatures">
              <div class="feature-header">
                <i class="feature-icon"></i>
                <h4 class="feature-title">{{ feature.title }}</h4>
              </div>
              <p class="feature-desc">{{ feature.description }}</p>
              <ul class="feature-highlights">
                <li *ngFor="let highlight of feature.highlights">{{ highlight }}</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="modal-side-col">
          
          <div class="modal-section" *ngIf="selectedProject.results">
            <h3 class="modal-section-title">Key Outcomes</h3>
            <ul class="results-list">
              <li *ngFor="let result of selectedProject.results">
                <span class="check-icon">âœ“</span> {{ result }}
              </li>
            </ul>
          </div>

          <div class="modal-section">
            <h3 class="modal-section-title">Project Links</h3>
            <div class="modal-actions">
              <a *ngIf="selectedProject.ghLink" [href]="selectedProject.ghLink" target="_blank" class="modal-action-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
                <span>View Source</span>
              </a>
              <a *ngIf="selectedProject.demoLink" [href]="selectedProject.demoLink" target="_blank" class="modal-action-btn primary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                <span>Live Demo</span>
              </a>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>
</div>